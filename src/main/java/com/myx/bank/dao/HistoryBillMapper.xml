<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.myx.bank.dao.HistoryBillDao">
    <select id="getHistoryBillList" resultType="com.myx.bank.pojo.HistoryBill">
        select sender, payee, value, type, a.name as SenderName, b.name as PayeeName
        from bill,
             user as a,
             user as b
        where a.id = bill.sender
          and b.id = bill.payee;
    </select>
    <select id="getHistoryBillListById" parameterType="int" resultType="com.myx.bank.pojo.HistoryBill">
        select distinct sender, payee, value, type, a.name as SenderName, b.name as PayeeName
        from bill,
             user as a,
             user as b
        where (bill.sender = #{id} or bill.payee = #{id})
          and (a.id = bill.sender
          or b.id = bill.payee)
    </select>
    <insert id="insertHistoryBill" parameterType="com.myx.bank.pojo.Bill">
        insert into bill
        values (#{sender}, #{payee}, #{value}, #{type})
    </insert>
    <insert id="insertHistoryWithdrawBill" parameterType="com.myx.bank.pojo.Bill">
        insert into bill(sender, value, type)
        values (#{sender}, #{value}, #{type})
    </insert>
    <insert id="insertHistoryDepositBill" parameterType="com.myx.bank.pojo.Bill">
        insert into bill(payee, value, type)
        values (#{payee}, #{value}, #{type})
    </insert>
    <delete id="deleteHistoryBill" parameterType="com.myx.bank.pojo.Bill">
        delete
        from bill
        where sender = #{sender}
          and payee = #{payee}
          and value = #{value}
          and type = #{type}
    </delete>

</mapper>
